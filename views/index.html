<h1>Make a Course Watch Request</h1>


<!-- {{#each entries}}
<p>
<a href="/article/{{id}}">{{title}}</a><br/>
Published: {{published}}
</p>
{{/each}}
 -->

<script>
	

var socket = io.connect('http://localhost');
socket.on('connect_success', function (data) {
	console.log(data);
});

$(document).ready(function(){
	//validation

	$(".alert").hide();

	$("#send_request").click(function(){
		var errorCount = 0;

		var crnInput = $('#inputCRN').val();
		var emailInput = $('#inputEmail').val();

		if(!isEmail(emailInput)){
			$('#email_alert').show();
			errorCount++;
		}else{
			$('#email_alert').hide();
		}

		if(!isCRN(crnInput)){
			$('#crn_alert').show();
			errorCount++;
		}else{
			$('#crn_alert').hide();
		}

		if(!errorCount){
			$(".alert").hide();
			$("#success_alert").show();
			socket.emit('makeRequest', { email: emailInput, crn: crnInput});
		}

	});

});


function isEmail(email) {
	var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
	return regex.test(email);
}

function isCRN(crn){
	var regex = /\b\d{5}\b/g;
	return regex.test(crn)
}

</script>


<div id = "email_alert" class="alert alert-danger">
  <button type="button" class="close" data-dismiss="alert">&times;</button>
  Invalid email x.x
</div>

<div id = "crn_alert" class="alert alert-danger">
  <button type="button" class="close" data-dismiss="alert">&times;</button>
  Invalid crn x.x
</div>


<div id = "success_alert" class="alert alert-success">
  <button type="button" class="close" data-dismiss="alert">&times;</button>
  Request submitted to server! You'll be emailed, when a spot is open.
</div>

<form>
<label for="inputEmail">Email </label>
<input type="text" class="form-control" id="inputEmail" placeholder="Whats your email?">

<label for="inputCRN">CRN </label>
<input type="text" class="form-control" id="inputCRN" placeholder="Whats the CRN?">

</form>

<button id= "send_request" class="btn btn-primary">Request</button>